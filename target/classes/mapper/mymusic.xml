<?xml version="1.0" encoding="UTF-8"?>

<!-- DTD(Document Type Definition)
	 - 작성한 문서가 어떤문서인지에 대해서 정의하는 것 
	 - 하나의 시스템 내에서 사용할 XML 데엍의 구조를 정의하여 유효성을 점검시 사용함 -->

<!DOCTYPE mapper
    PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
    "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
    
<mapper namespace="MyMusicDAO">
	<select id="select_playlist" parameterType="int" resultType="PlaylistDTO">
		select distinct playlist_no, playlist_name, playlist_thumbnail from music_playlist where user_no = #{user_no} order by playlist_no
	</select>
	
	<select id="select_playlistcount" parameterType="int" resultType="PlaylistDTO">
		<![CDATA[
			select playlist_no, max(m_order) as m_order from music_playlist where user_no = #{user_no} group by playlist_no
		]]>
	</select>

	<select id="selete_like" parameterType="int" resultType="MusicDTO">
		<![CDATA[
			select m_no, m_name from music where m_no in (select m_no from music_by_user where user_no = #{user_no} and play_thumbs = 'true')
		]]>
	</select>
	
	<select id="recent_watch" parameterType="int" resultType="MusicDTO">
		select m.* from music m, music_by_user u where m.m_no = u.m_no and user_no = #{user_no} order by play_date desc
	</select>
	
	<select id="much_watch" parameterType="int" resultType="MusicDTO">
		select m.* from music m, music_by_user u where m.m_no = u.m_no and user_no = #{user_no} order by play_counts desc, u.m_no
	</select>

</mapper>
